
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>RTP EM BMB</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      font-size: 14px;
      background-color: #f4f4f4;
      padding: 20px;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #fff;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #eee;
    }
    button {
      margin: 2px;
      padding: 4px 8px;
    }
    .top-buttons, .bottom-buttons {
      display: flex;
      justify-content: flex-end;
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h2>RTP EM BMB</h2>

  <div class="top-buttons">
    <button onclick="loadFromJSON()">Load JSON</button>
    <button onclick="saveToJSON()">Save to JSON</button>
  </div>

  <table id="dataTable">
    <thead>
      <tr>
        <th>No</th>
        <th>Issue</th>
        <th>Action Plan</th>
        <th>PIC</th>
        <th>Due</th>
        <th>Status</th>
        <th>Remarks</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="bottom-buttons">
    <button id="addRowBtn">Add New Row</button>
  </div>

  <script>
    let data = [
      {
        no: 1,
        issue: "PM Accuracy Achivement 100%",
        action: "Juli Actual achivement 98%",
        pic: "Endar",
        due: "Agustus",
        status: "Continue",
        remarks: "Target 90 di Desember"
      }
    ];

    const tableBody = document.querySelector("#dataTable tbody");

    function renderTable() {
      tableBody.innerHTML = "";
      data.forEach((row, index) => {
        const tr = document.createElement("tr");

        Object.values(row).forEach((value) => {
          const td = document.createElement("td");
          td.textContent = value;
          tr.appendChild(td);
        });

        const actionTd = document.createElement("td");
        actionTd.innerHTML = `
          <button onclick="editRow(${index})">Edit</button>
          <button onclick="saveRow(${index})">Save</button>
          <button onclick="deleteRow(${index})">Delete</button>
        `;
        tr.appendChild(actionTd);
        tableBody.appendChild(tr);
      });
    }

    function addRow() {
      data.push({
        no: data.length + 1,
        issue: "",
        action: "",
        pic: "",
        due: "",
        status: "",
        remarks: ""
      });
      renderTable();
    }

    function editRow(index) {
      const row = tableBody.rows[index];
      for (let i = 0; i < 7; i++) {
        const cell = row.cells[i];
        const input = document.createElement("input");
        input.value = cell.textContent;
        cell.textContent = "";
        cell.appendChild(input);
      }
    }

    function saveRow(index) {
      const row = tableBody.rows[index];
      const updated = {};
      for (let i = 0; i < 7; i++) {
        const input = row.cells[i].querySelector("input");
        updated[Object.keys(data[index])[i]] = input ? input.value : row.cells[i].textContent;
      }
      data[index] = updated;
      renderTable();
      saveToJSON();
    }

    function deleteRow(index) {
      data.splice(index, 1);
      renderTable();
      saveToJSON();
    }

    function saveToJSON() {
      const jsonData = JSON.stringify(data, null, 2);
      const blob = new Blob([jsonData], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "data.json";
      a.click();
      URL.revokeObjectURL(url);
    }

    function loadFromJSON() {
      const input = document.createElement("input");
      input.type = "file";
      input.accept = ".json";
      input.onchange = (e) => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = (event) => {
          data = JSON.parse(event.target.result);
          renderTable();
        };
        reader.readAsText(file);
      };
      input.click();
    }

    document.getElementById("addRowBtn").addEventListener("click", addRow);

    renderTable();
  </script>
</body>
</html>
